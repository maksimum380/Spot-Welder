<h2 align="center">Контактна зварка.</h2>

### Папки та файли:

    Hard       Електронні схеми та друковані плати для PCAD, а також файли для друку у форматі pdf.
    Pictures   Фото зроблені в міру виготовлення пристрою.
    Soft       Файли із програмою на С++ (MPLAB Xpress & XC8 compiler), а також прошивка для PIC12F675.
    README.md  Цей файл.
---
### З чого все почалося:

Почалося з того, що принесли в ремонт дешевий китайський зварювальний апарат, зібраний на п'яти MOSFET 4N04R8.

![chinese spot welding pcb](https://github.com/nva1773/Spot-Welder/blob/main/Pictures/chinese-spot-welding-pcb.jpg)

По друкованій платі намалював схему, знайшов причину несправності (було пробито одного MOSFET з транзисторів).

![chinese spot welding sch](https://github.com/nva1773/Spot-Welder/blob/main/Pictures/chinese-spot-welding-sch.jpg)

Замінив, перевірив, зняв осцилограми. Пристрій мав 3 режиму роботи (тривалість вихідного імпульсу зварювання 7, 11, 15 ms), індикація яких реалізована на триколірному світлодіоді.
Через деякий час знадобилося з'єднати акумулятори 18650 для PowerBank, та й вирішив зробити свій зварювальний апарат, схожий на китайський, але з невеликими доробками.

Елементна база вибралася з принципу, що є, купувати ні чого не хотілося.

Як мікроконтролер був обраний PIC12F675, для індикації режимів взяв 7-сегмент LED і дешифратор KР514ІД2 (CD4511), драйвер TC4429, MOSFET транзистори AUFS8409-7P.
    
### Опис:

Пристрій запитується від автомобільної 12В акумуляторної батареї та має захист від переполюсування.

Схема керування:
![Control circuit](https://github.com/nva1773/Spot-Welder/blob/main/Pictures/spot-welder-control.JPG)

Схема живлення:
![Power circuit](https://github.com/nva1773/Spot-Welder/blob/main/Pictures/spot-welder-power.JPG)

Реалізовано 8 режимів роботи, 0 – видача зварювального імпульсу відключена, 1 – 7 видача зварювального імпульсу від 7 до 24 ms з кроком 3 ms.
Запуск процесу зварювання може здійснюватися в атематичному режимі або вручну (вибирається перемичкою на JP1).
Для автоматичного запуску просто потрібно торкнутися електродами деталей, що зварюються, і через 500 ms буде виданий зварювальний імпульс. Якщо продовжити притискати електроди, буде подано повторний імпульс через 1s.
У ручному режимі запуск імпульсу зварювання подається натисканням і утриманням зовнішньої кнопки запуску, наприклад, педаллю ножа.

### Виготовлення:

Схему та друковану плату розвів у PCAD, виготовлення печатки простим "прасним" методом - друкуємо на крейдяному папері за допомогою лазерного принтера, праскою переносимо тонер на фольгований текстоліт (1), травимо (наприклад у хлорному залозі) (2), зачищаємо, свердлимо та лудимо (3):

![Making of the control board](https://github.com/nva1773/Spot-Welder/blob/main/Pictures/pcb-build-1.jpg)

Запаюємо деталі і подаємо напругу, без мікропроцесора на дисплеї повинна бути цифра 7:

![Making of the power board](https://github.com/nva1773/Spot-Welder/blob/main/Pictures/pcb-build-2.jpg)

### Отримання прошивки:

Програма була написана у безкоштовному середовищі розробки від Microchip [MPLAB Xpress] (https://mplabxpress.microchip.com/mplabcloud/ide) на Сі та скомпільована безкоштовним копілятором XC8. Сам процес створення проекту дуже простий, реєструємось на сайті, натискаємо кнопку "New project", вибираємо проект "Standalone project" натискаємо "Next", вибираємо CPU ввівши в поле "Device" PIC12F675 натискаємо "Next", вводимо ім'я проекту (наприклад: Spot -Welder) і тиснемо "Finish". У властивостях проекту вибираємо компілятор "XC8". Імпортуємо Header (.h) та Source (.c) файли та збираємо проект натиснувши "Build Project". Після компіляції натискаємо "Make and Program Device" у результаті на комп'ютер завантажиться файл з прошивкою (spot-welder.hex).

![MPLAB Xpress Project](https://github.com/nva1773/Spot-Welder/blob/main/Pictures/www.mplab-xpresside.micorchip.com.JPG)

Для автоматизації отримання вихідних даних для CPU (затримка видачі керуючого імпульсу) створено таблицю [файл Excel](https://github.com/nva1773/Spot-Welder/blob/main/Soft/DurationPulse.xlsm) з макросом, який потрібен для спрощення отримання даних у вигляді списку значень у текстовому вигляді. Дані копіюються в масив "table_pulse" файлу spotwelder.c.

Якщо немає необхідності змінювати програму, то готова прошивка знаходиться в папці [firmware](https://github.com/nva1773/Spot-Welder/blob/main/Soft/Spot_welder.X.production.hex) . Також є архів з проектом, імпортованим з MPLAB Express.
